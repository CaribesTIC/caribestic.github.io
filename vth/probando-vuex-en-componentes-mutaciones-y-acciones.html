<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Probando Vuex en componentes | Vue(tdd)</title>
    <meta name="description" content="TDD con Vue 3.">
    <link rel="stylesheet" href="/vue-tdd/assets/style.c3210e46.css">
    <link rel="modulepreload" href="/vue-tdd/assets/app.6d5336e7.js">
    <link rel="modulepreload" href="/vue-tdd/assets/vth_probando-vuex-en-componentes-mutaciones-y-acciones.md.d7a9fee6.lean.js">
    
    <meta name="twitter:title" content="Probando Vuex en componentes | Vue(tdd)">
  <meta property="og:title" content="Probando Vuex en componentes | Vue(tdd)">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme"><header class="nav-bar" data-v-675d8756><div class="sidebar-button" data-v-675d8756><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z" class></path></svg></div><a class="nav-bar-title" href="/vue-tdd/" aria-label="Vue(tdd), back to home" data-v-675d8756 data-v-cc01ef16><img class="logo" src="/vue-tdd/logo.png" alt="Logo" data-v-cc01ef16> Vue(tdd)</a><div class="flex-grow" data-v-675d8756></div><div class="nav" data-v-675d8756><nav class="nav-links" data-v-675d8756 data-v-eab3edfe><!--[--><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/vue-tdd/" data-v-b8818f8c>Home <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/vue-tdd/comenzar/tdd" data-v-b8818f8c>Guide <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item isExternal" href="https://github.com/CaribesTIC/vue-tdd" target="_blank" rel="noopener noreferrer" data-v-b8818f8c>GitHub <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-b8818f8c><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><!--]--><!----><!----></nav></div><!--[--><!--]--></header><aside class="sidebar" data-v-83e92a68><nav class="nav-links nav" data-v-83e92a68 data-v-eab3edfe><!--[--><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/vue-tdd/" data-v-b8818f8c>Home <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/vue-tdd/comenzar/tdd" data-v-b8818f8c>Guide <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item isExternal" href="https://github.com/CaribesTIC/vue-tdd" target="_blank" rel="noopener noreferrer" data-v-b8818f8c>GitHub <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-b8818f8c><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><!--]--><!----><!----></nav><!--[--><!--]--><ul class="sidebar-links" data-v-83e92a68><!--[--><li class="sidebar-link"><p class="sidebar-link-item">Comenzar</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/comenzar/tdd">Desarrollo Dirigido por Pruebas</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/comenzar/pruebas-unitarias">Pruebas Unitarias</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">Vitest</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vitest/porque-vitest">¿Por qué Vitest?</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vitest/entorno-de-prueba">Entorno de Prueba</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vitest/usando-comparadores">Usando Comparadores</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vitest/configuracion-y-desmontaje">Configuración y Desmontaje</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vitest/filtrando-pruebas">Filtrando Pruebas</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vitest/probando-codigo-asincrono">Probando Código Asíncrono</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vitest/un-ejemplo-asincrono">Un Ejemplo Asíncrono</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vitest/funciones-simuladas">Funciones Simuladas</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vitest/simulaciones">Simulaciones</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vitest/simulaciones-de-temporizador">Simulaciones de Temporizador</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vitest/simulaciones-de-clase-es6">Simulaciones de Clase ES6</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">Vue Tests Utils</p><ul class="sidebar-links"><li class="sidebar-link"><p class="sidebar-link-item">Esencial</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtu/esencial/intro">¿Qué es Vue Test Utils?</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtu/esencial/entorno-de-prueba">Entorno de Prueba</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtu/esencial/un-curso-acelerado">Un Curso Acelerado</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtu/esencial/renderizado-condicional">Renderizado Condicional</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtu/esencial/manejo-de-eventos">Probando el Manejo de Eventos</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtu/esencial/formularios">Probando Formularios</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtu/esencial/pasando-datos-a-componentes">Pasando Datos a Componentes</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtu/esencial/escribir-componentes-que-sean faciles-de-probar">Escribir componentes que sean fáciles de probar</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">Vue Test Utils en-profundidad</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtu/vue-test-utils-en-profundidad/ranuras">Ranuras</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtu/vue-test-utils-en-profundidad/comportamiento-asincrono">Comportamiento Asíncrono</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtu/vue-test-utils-en-profundidad/solicitudes-http">Realizando Solicitudes HTTP</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtu/vue-test-utils-en-profundidad/transiciones">Transiciones</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtu/vue-test-utils-en-profundidad/instancia-de-componente">Instancia de Componente</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtu/vue-test-utils-en-profundidad/reusabilidad-y-composicion">Reusabilidad &amp; Composición</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtu/vue-test-utils-en-profundidad/probando-vuex">Probando Vuex</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtu/vue-test-utils-en-profundidad/un-poco-mas-sobre-vuex">Un poco más sobre Vuex</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtu/vue-test-utils-en-profundidad/probando-vue-router">Probando Vue Router</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtu/vue-test-utils-en-profundidad/probando-teleport">Probando Teleport</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtu/vue-test-utils-en-profundidad/talones-y-montaje-superficial">Talones y Montaje Superficial</a><!----></li></ul></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">Vue Testing Handbook</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vth/renderizar-componentes">Renderizar Componentes</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vth/probando-propiedades">Probando Propiedades</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vth/propiedades-calculadas">Propiedades Calculadas</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vth/simulando-la-entrada-del-usuario">Simulando la entrada del usuario</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vth/probando-eventos-emitidos">Probando Eventos Emitidos</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vth/simulando-objetos-globales">Simulando Objetos Globales</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vth/talonando-componentes">Talonando Componentes</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vth/encontrando-elementos-y-componentes">Encontrando elementos y componentes</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vth/probando-vuex">Probando Vuex</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vth/vuex-mutaciones">Vuex Mutaciones</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vth/vuex-acciones">Vuex Accciones</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vth/vuex-captadores">Vuex Captadores</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vth/probando-vuex-en-componentes">Probando Vuex en componentes - estados y captadores</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item active" href="/vue-tdd/vth/probando-vuex-en-componentes-mutaciones-y-acciones">Probando Vuex en componentes - mutaciones y acciones</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#mutaciones-y-acciones">Mutaciones y Acciones</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#crear-el-componente">Crear el componente</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#probando-con-una-tienda-vuex-real">Probando con una tienda Vuex real</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#probando-usando-una-tienda-simulada">Probando usando una tienda simulada</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#probando-una-accion-o-mutacion-con-espacio-de-nombre">Probando una Acción (o Mutación) con Espacio de Nombre</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#conclusion">Conclusión</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vth/vue-router">Vue Router</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vth/api-de-composicion">API de Composición</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vth/reduciendo-repetitividad-en-las-pruebas">Reduciendo Repetitividad en las Pruebas</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">Vue Testing Library</p><ul class="sidebar-links"><li class="sidebar-link"><p class="sidebar-link-item">Documentación</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtl/documentacion/intro">¿Qué es Testing Library?</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtl/documentacion/guias-de-principios">Guías de Principios</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtl/documentacion/intro-v">¿Qué es Vue Testing Library?</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtl/documentacion/ejemplos">Ejemplos</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">Prueba Simples y Completas</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtl/psyc/consultas-dom">Consultas DOM</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtl/psyc/filosofia">Filosofía</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtl/psyc/getby-queryby-findby">getBy, queryBy y findBy</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtl/psyc/fireevent-waitfor">fireEvent y waitFor</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtl/psyc/findby-para-consultas-asincronicas">findBy para consultas asincrónicas</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtl/psyc/trabajar-con-formularios">Trabajar con Formularios</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtl/psyc/enviar-formularios-y-emitir-eventos">Enviar formularios y emitir eventos</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">Diseño Dirigido por Pruebas</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtl/ddp/intro">Introducción</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtl/ddp/patrones-para-probar-accesorios">Patrones para Probar Accesorios</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtl/ddp/emitir-eventos">Emitir Eventos</a><!----></li></ul></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">Pinia</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/pinia/probando-pinia">Probando Pinia</a><!----></li></ul></li><!--]--></ul><!--[--><!--]--></aside><div class="sidebar-mask"></div><main class="page" data-v-7eddb2c4><div class="container" data-v-7eddb2c4><!--[--><!--]--><div style="position:relative;" class="content" data-v-7eddb2c4><div><h1 id="probando-vuex-en-componentes" tabindex="-1">Probando Vuex en componentes <a class="header-anchor" href="#probando-vuex-en-componentes" aria-hidden="true">#</a></h1><h2 id="mutaciones-y-acciones" tabindex="-1">Mutaciones y Acciones <a class="header-anchor" href="#mutaciones-y-acciones" aria-hidden="true">#</a></h2><p>La guía anterior discutió la prueba de componentes que usan <code>$store.state</code> y <code>$store.getters</code>, que proporcionan el estado actual del componente. Cuando afirmar un componente correctamente comete una mutación o envía una acción, lo que realmente queremos hacer es afirmar <code>$store.commit</code> y <code>$store.dispatch</code> se llama con el controlador correcto (la mutación o acción a llamar) y la carga útil.</p><p>Hay dos maneras de hacer esto. Una es usar una tienda Vuex real con <code>createStore</code> y otra es usar una tienda simulada. Ambas técnicas se demuestran <a href="/vue-tdd/vth/probando-vuex-en-componentes.html">aquí</a>. Veámoslos de nuevo, en el contexto de mutaciones y acciones.</p><p>El código fuente de la prueba descrita en esta página se puede encontrar <a href="https://github.com/lmiller1990/vue-testing-handbook/blob/master/demo-app-vue-3/tests/unit/ComponentWithButtons.spec.js" target="_blank" rel="noopener noreferrer">aquí</a>.</p><h2 id="crear-el-componente" tabindex="-1">Crear el componente <a class="header-anchor" href="#crear-el-componente" aria-hidden="true">#</a></h2><p>Para estos ejemplos, probaremos un componente <code>&lt;ComponentWithButtons&gt;</code>:</p><div class="language-vue"><pre><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> 
      <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>commit<span class="token punctuation">&quot;</span></span> 
      <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>handleCommit<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      Commit
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> 
      <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dispatch<span class="token punctuation">&quot;</span></span> 
      <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>handleDispatch<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      Dispatch
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> 
      <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>namespaced-dispatch<span class="token punctuation">&quot;</span></span> 
      <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>handleNamespacedDispatch<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      Namespaced Dispatch
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;ComponentWithButtons&quot;</span><span class="token punctuation">,</span>

  <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">handleCommit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;testMutation&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">&quot;Test Commit&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token function">handleDispatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">&quot;testAction&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">&quot;Test Dispatch&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token function">handleNamespacedDispatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">&quot;namespaced/very/deeply/testAction&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">&quot;Test Namespaced Dispatch&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="probando-con-una-tienda-vuex-real" tabindex="-1">Probando con una tienda Vuex real <a class="header-anchor" href="#probando-con-una-tienda-vuex-real" aria-hidden="true">#</a></h2><p>Primero escribamos un <code>ComponentWithButtons.spec.js</code> con una prueba para la mutación. Recuerda, queremos verificar dos cosas:</p><ol><li>¿Se cometió la mutación correcta?</li><li>¿La carga útil era correcta?</li></ol><p>Veamos la prueba.</p><div class="language-js"><pre><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vuex&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> mount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@vue/test-utils&quot;</span>
<span class="token keyword">import</span> ComponentWithButtons <span class="token keyword">from</span> <span class="token string">&quot;@/components/ComponentWithButtons.vue&quot;</span>

<span class="token keyword">const</span> mutations <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">testMutation</span><span class="token operator">:</span> vi<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  mutations
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&quot;ComponentWithButtons&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&quot;commits a mutation when a button is clicked&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span>ComponentWithButtons<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">global</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>store<span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    wrapper<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">&quot;.commit&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trigger</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">await</span> wrapper<span class="token punctuation">.</span>vm<span class="token punctuation">.</span><span class="token function">$nextTick</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    

    <span class="token function">expect</span><span class="token punctuation">(</span>mutations<span class="token punctuation">.</span>testMutation<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveBeenCalledWith</span><span class="token punctuation">(</span>
      <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">&quot;Test Commit&quot;</span> <span class="token punctuation">}</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>Observe que las pruebas están marcadas como <code>await</code> y llame a <code>nextTick</code>. Vea <a href="./../vth/simulando-la-entrada-del-usuario.html#escribiendo-la-prueba">aquí</a> para más detalles sobre por qué.</p><p>Hay mucho código en la prueba anterior; sin embargo, no está sucediendo nada demasiado emocionante. Creamos una nueva tienda con <code>createStore</code>, pasando una función simulada de Vitest (vi.fn()) en lugar de <code>testMutation</code>. Las mutaciones de Vuex siempre se llaman con dos argumentos: el primero es el estado actual y el segundo es la carga útil. Dado que no declaramos ningún estado para la tienda, esperamos que se llame con un objeto vacío. Se espera que el segundo argumento sea <code>{ msg: &quot;Test Commit&quot; }</code>, que está codificado en el componente.</p><p>Esto es mucho código repetitivo para escribir, pero es una forma correcta y válida de verificar que los componentes se comporten correctamente. Otra alternativa que requiere menos código es usar una tienda simulada. Veamos cómo hacerlo mientras se escribe una prueba para afirmar que se envía <code>testAction</code>.</p><h2 id="probando-usando-una-tienda-simulada" tabindex="-1">Probando usando una tienda simulada <a class="header-anchor" href="#probando-usando-una-tienda-simulada" aria-hidden="true">#</a></h2><p>Veamos el código, luego comparemos y contrastemos con la prueba anterior. Recuerda, queremos verificar:</p><ol><li>Se envía la acción correcta</li><li>La carga útil es correcta</li></ol><div class="language-js"><pre><code><span class="token keyword">import</span> <span class="token punctuation">{</span> mount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@vue/test-utils&quot;</span>
<span class="token keyword">import</span> ComponentWithButtons <span class="token keyword">from</span> <span class="token string">&quot;@/components/ComponentWithButtons.vue&quot;</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&quot;ComponentWithButtons&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&quot;dispatches an action when a button is clicked&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> mockStore <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">dispatch</span><span class="token operator">:</span> vi<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
    <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span>ComponentWithButtons<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">global</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">mocks</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">$store</span><span class="token operator">:</span> mockStore 
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    wrapper<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">&quot;.dispatch&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trigger</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">await</span> wrapper<span class="token punctuation">.</span>vm<span class="token punctuation">.</span><span class="token function">$nextTick</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token function">expect</span><span class="token punctuation">(</span>mockStore<span class="token punctuation">.</span>dispatch<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveBeenCalledWith</span><span class="token punctuation">(</span>
      <span class="token string">&quot;testAction&quot;</span> <span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">&quot;Test Dispatch&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>Esto es mucho más compacto que el ejemplo anterior. Sin crear tienda. En lugar de burlarnos de la función, en el caso anterior donde hicimos <code>testMutation = vi.fn()</code>, en realidad nos burlamos de la función <code>dispatch</code> en sí. Dado que <code>$store.dispatch</code> es solo una función normal de JavaScript, podemos hacer esto. Luego afirmamos que el controlador de acción correcto, <code>testAction</code>, es el primer argumento, y el segundo argumento, la carga útil, es correcto. No nos importa lo que realmente hace la acción - eso se puede probar de forma aislada. El objetivo de esta prueba es simplemente verificar que hacer click en un botón envía la acción correcta con la carga útil.</p><p>Ya sea que use una tienda real o una tienda simulada, sus pruebas se reducen a sus preferencias personales. Ambos son correctos. Lo importante es que estás probando tus componentes.</p><h2 id="probando-una-accion-o-mutacion-con-espacio-de-nombre" tabindex="-1">Probando una Acción (o Mutación) con Espacio de Nombre <a class="header-anchor" href="#probando-una-accion-o-mutacion-con-espacio-de-nombre" aria-hidden="true">#</a></h2><p>El tercer y último ejemplo muestra otra forma de probar que se envió una acción (o se cometió una mutación) con los argumentos correctos. Esto combinó las dos técnicas discutidas anteriormente: una tienda <code>Vuex</code> real y un método <code>dispatch</code> simulado.</p><div class="language-js"><pre><code><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&quot;dispatch a namespaced action when button is clicked&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  store<span class="token punctuation">.</span>dispatch <span class="token operator">=</span> vi<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span>ComponentWithButtons<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">global</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>store<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  wrapper<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">&quot;.namespaced-dispatch&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trigger</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">await</span> wrapper<span class="token punctuation">.</span>vm<span class="token punctuation">.</span><span class="token function">$nextTick</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token function">expect</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span>dispatch<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveBeenCalledWith</span><span class="token punctuation">(</span>
    <span class="token string">&#39;namespaced/very/deeply/testAction&#39;</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">&quot;Test Namespaced Dispatch&quot;</span> <span class="token punctuation">}</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>Comenzamos creando una tienda Vuex, con los módulos que nos interesan. Declaro el módulo <code>namespacedModule</code> dentro de la prueba, pero en una aplicación del mundo real, solo importaría los módulos de los que depende su componente. Luego reemplazamos el método <code>dispatch</code> con un simulacro de <code>vi.fn</code> y hacemos afirmaciones en contra de eso.</p><h2 id="conclusion" tabindex="-1">Conclusión <a class="header-anchor" href="#conclusion" aria-hidden="true">#</a></h2><p>En esta sección cubrimos:</p><ul><li>Usando Vuex con <code>createStore</code> y burlándose de una mutación</li><li>Burlándose de la API de Vuex (<code>dispatch</code> y <code>commit</code>)</li><li>Usar una tienda Vuex real con una función de <code>dispatch</code> simulada</li></ul><p>El código fuente de la prueba descrita en esta página se puede encontrar <a href="https://github.com/lmiller1990/vue-testing-handbook/blob/master/demo-app-vue-3/tests/unit/ComponentWithButtons.spec.js" target="_blank" rel="noopener noreferrer">aquí</a>.</p></div></div><footer class="page-footer" data-v-7eddb2c4 data-v-07c132fc><div class="edit" data-v-07c132fc><div class="edit-link" data-v-07c132fc data-v-1ed99556><!----></div></div><div class="updated" data-v-07c132fc><!----></div></footer><div class="next-and-prev-link" data-v-7eddb2c4 data-v-38ede35f><div class="container" data-v-38ede35f><div class="prev" data-v-38ede35f><a class="link" href="/vue-tdd/vth/probando-vuex-en-componentes" data-v-38ede35f><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon icon-prev" data-v-38ede35f><path d="M19,11H7.4l5.3-5.3c0.4-0.4,0.4-1,0-1.4s-1-0.4-1.4,0l-7,7c-0.1,0.1-0.2,0.2-0.2,0.3c-0.1,0.2-0.1,0.5,0,0.8c0.1,0.1,0.1,0.2,0.2,0.3l7,7c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3c0.4-0.4,0.4-1,0-1.4L7.4,13H19c0.6,0,1-0.4,1-1S19.6,11,19,11z"></path></svg><span class="text" data-v-38ede35f>Probando Vuex en componentes - estados y captadores</span></a></div><div class="next" data-v-38ede35f><a class="link" href="/vue-tdd/vth/vue-router" data-v-38ede35f><span class="text" data-v-38ede35f>Vue Router</span><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon icon-next" data-v-38ede35f><path d="M19.9,12.4c0.1-0.2,0.1-0.5,0-0.8c-0.1-0.1-0.1-0.2-0.2-0.3l-7-7c-0.4-0.4-1-0.4-1.4,0s-0.4,1,0,1.4l5.3,5.3H5c-0.6,0-1,0.4-1,1s0.4,1,1,1h11.6l-5.3,5.3c-0.4,0.4-0.4,1,0,1.4c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3l7-7C19.8,12.6,19.9,12.5,19.9,12.4z"></path></svg></a></div></div></div><!--[--><!--]--></div></main></div><!----><!--]--></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"comenzar_pruebas-unitarias.md\":\"15068691\",\"comenzar_tdd.md\":\"c66f90bf\",\"index.md\":\"9891a602\",\"pinia_probando-pinia.md\":\"7d2d6848\",\"vitest_configuracion-y-desmontaje.md\":\"1b7531ea\",\"vitest_entorno-de-prueba.md\":\"9bcee370\",\"vitest_filtrando-pruebas.md\":\"8c9ec14b\",\"vitest_funciones-simuladas.md\":\"2b29d25b\",\"vitest_porque-vitest.md\":\"2d574df3\",\"vitest_probando-codigo-asincrono.md\":\"3c8d559d\",\"vitest_simulaciones-de-clase-es6.md\":\"6526d34f\",\"vitest_simulaciones-de-temporizador.md\":\"d115037b\",\"vitest_simulaciones.md\":\"5e63859f\",\"vitest_un-ejemplo-asincrono.md\":\"9f024ce2\",\"vitest_usando-comparadores.md\":\"6d632681\",\"vth_api-de-composicion.md\":\"84d61adf\",\"vth_encontrando-elementos-y-componentes.md\":\"a9417fa9\",\"vth_probando-eventos-emitidos.md\":\"3cdc637b\",\"vth_probando-propiedades.md\":\"7950130d\",\"vth_probando-vuex-en-componentes-mutaciones-y-acciones.md\":\"d7a9fee6\",\"vth_probando-vuex-en-componentes.md\":\"1b8a7399\",\"vth_probando-vuex.md\":\"a0f18739\",\"vth_propiedades-calculadas.md\":\"9a383892\",\"vth_reduciendo-repetitividad-en-las-pruebas.md\":\"92abdf29\",\"vth_renderizar-componentes.md\":\"cf590215\",\"vth_simulando-la-entrada-del-usuario.md\":\"c494df8c\",\"vth_simulando-objetos-globales.md\":\"65345f50\",\"vth_talonando-componentes.md\":\"265707fb\",\"vth_vue-router.md\":\"4d743cab\",\"vth_vuex-acciones.md\":\"64db279a\",\"vth_vuex-captadores.md\":\"d2c04e3f\",\"vth_vuex-mutaciones.md\":\"9080c662\",\"vtl_ddp_emitir-eventos.md\":\"69646f9a\",\"vtl_ddp_intro.md\":\"e9187474\",\"vtl_ddp_patrones-para-probar-accesorios.md\":\"ac11d951\",\"vtl_documentacion_ejemplos.md\":\"16cd8638\",\"vtl_documentacion_guias-de-principios.md\":\"671d0ee2\",\"vtl_documentacion_intro-v.md\":\"7fee074f\",\"vtl_documentacion_intro.md\":\"aba77760\",\"vtl_psyc_consultas-dom.md\":\"8e8f5f68\",\"vtl_psyc_enviar-formularios-y-emitir-eventos.md\":\"7ffc38b3\",\"vtl_psyc_filosofia.md\":\"8f98be55\",\"vtl_psyc_findby-para-consultas-asincronicas.md\":\"a4fa8658\",\"vtl_psyc_fireevent-waitfor.md\":\"62d3e533\",\"vtl_psyc_getby-queryby-findby.md\":\"7da9f67d\",\"vtl_psyc_trabajar-con-formularios.md\":\"e662f420\",\"vtu_esencial_entorno-de-prueba.md\":\"4c698965\",\"vtu_esencial_escribir-componentes-que-sean faciles-de-probar.md\":\"611ac1af\",\"vtu_esencial_formularios.md\":\"97b51baa\",\"vtu_esencial_intro.md\":\"2bc4d905\",\"vtu_esencial_manejo-de-eventos.md\":\"27b86fdf\",\"vtu_esencial_pasando-datos-a-componentes.md\":\"90a22fd8\",\"vtu_esencial_renderizado-condicional.md\":\"c73950b6\",\"vtu_esencial_un-curso-acelerado.md\":\"84516108\",\"vtu_vue-test-utils-en-profundidad_comportamiento-asincrono.md\":\"fe214edc\",\"vtu_vue-test-utils-en-profundidad_instancia-de-componente.md\":\"7556aefa\",\"vtu_vue-test-utils-en-profundidad_probando-teleport.md\":\"94c6a425\",\"vtu_vue-test-utils-en-profundidad_probando-vue-router.md\":\"0d75c7be\",\"vtu_vue-test-utils-en-profundidad_probando-vuex.md\":\"2b919933\",\"vtu_vue-test-utils-en-profundidad_ranuras.md\":\"ce1dca69\",\"vtu_vue-test-utils-en-profundidad_reusabilidad-y-composicion.md\":\"0e4d29c9\",\"vtu_vue-test-utils-en-profundidad_solicitudes-http.md\":\"dd9a9001\",\"vtu_vue-test-utils-en-profundidad_talones-y-montaje-superficial.md\":\"a9128da6\",\"vtu_vue-test-utils-en-profundidad_transiciones.md\":\"61789a8d\",\"vtu_vue-test-utils-en-profundidad_un-poco-mas-sobre-vuex.md\":\"de4f9e65\"}")</script>
    <script type="module" async src="/vue-tdd/assets/app.6d5336e7.js"></script>
    
  </body>
</html>