<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Patrones para Probar Accesorios | Vue(tdd)</title>
    <meta name="description" content="TDD con Vue 3.">
    <link rel="stylesheet" href="/vue-tdd/assets/style.c3210e46.css">
    <link rel="modulepreload" href="/vue-tdd/assets/app.c20c0d51.js">
    <link rel="modulepreload" href="/vue-tdd/assets/vtl_ddp_patrones-para-probar-accesorios.md.82bdd52c.lean.js">
    
    <meta name="twitter:title" content="Patrones para Probar Accesorios | Vue(tdd)">
  <meta property="og:title" content="Patrones para Probar Accesorios | Vue(tdd)">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme"><header class="nav-bar" data-v-675d8756><div class="sidebar-button" data-v-675d8756><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z" class></path></svg></div><a class="nav-bar-title" href="/vue-tdd/" aria-label="Vue(tdd), back to home" data-v-675d8756 data-v-cc01ef16><img class="logo" src="/vue-tdd/logo.png" alt="Logo" data-v-cc01ef16> Vue(tdd)</a><div class="flex-grow" data-v-675d8756></div><div class="nav" data-v-675d8756><nav class="nav-links" data-v-675d8756 data-v-eab3edfe><!--[--><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/vue-tdd/" data-v-b8818f8c>Home <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/vue-tdd/comenzar/tdd" data-v-b8818f8c>Guide <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item isExternal" href="https://github.com/CaribesTIC/vue-tdd" target="_blank" rel="noopener noreferrer" data-v-b8818f8c>GitHub <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-b8818f8c><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><!--]--><!----><!----></nav></div><!--[--><!--]--></header><aside class="sidebar" data-v-83e92a68><nav class="nav-links nav" data-v-83e92a68 data-v-eab3edfe><!--[--><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/vue-tdd/" data-v-b8818f8c>Home <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/vue-tdd/comenzar/tdd" data-v-b8818f8c>Guide <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item isExternal" href="https://github.com/CaribesTIC/vue-tdd" target="_blank" rel="noopener noreferrer" data-v-b8818f8c>GitHub <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-b8818f8c><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><!--]--><!----><!----></nav><!--[--><!--]--><ul class="sidebar-links" data-v-83e92a68><!--[--><li class="sidebar-link"><p class="sidebar-link-item">Comenzar</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/comenzar/tdd">Desarrollo Dirigido por Pruebas</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/comenzar/pruebas-unitarias">Pruebas Unitarias</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">Vitest</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vitest/porque-vitest">¿Por qué Vitest?</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vitest/entorno-de-prueba">Entorno de Prueba</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vitest/usando-comparadores">Usando Comparadores</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vitest/configuracion-y-desmontaje">Configuración y Desmontaje</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vitest/filtrando-pruebas">Filtrando Pruebas</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vitest/probando-codigo-asincrono">Probando Código Asíncrono</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vitest/un-ejemplo-asincrono">Un Ejemplo Asíncrono</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vitest/funciones-simuladas">Funciones Simuladas</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vitest/simulaciones">Simulaciones</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vitest/simulaciones-de-temporizador">Simulaciones de Temporizador</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vitest/simulaciones-de-clase-es6">Simulaciones de Clase ES6</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">Vue Tests Utils</p><ul class="sidebar-links"><li class="sidebar-link"><p class="sidebar-link-item">Esencial</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtu/esencial/intro">¿Qué es Vue Test Utils?</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtu/esencial/entorno-de-prueba">Entorno de Prueba</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtu/esencial/un-curso-acelerado">Un Curso Acelerado</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtu/esencial/renderizado-condicional">Renderizado Condicional</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtu/esencial/manejo-de-eventos">Probando el Manejo de Eventos</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtu/esencial/formularios">Probando Formularios</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtu/esencial/pasando-datos-a-componentes">Pasando Datos a Componentes</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtu/esencial/escribir-componentes-que-sean faciles-de-probar">Escribir componentes que sean fáciles de probar</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">Vue Test Utils en-profundidad</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtu/vue-test-utils-en-profundidad/ranuras">Ranuras</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtu/vue-test-utils-en-profundidad/comportamiento-asincrono">Comportamiento Asíncrono</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtu/vue-test-utils-en-profundidad/solicitudes-http">Realizando Solicitudes HTTP</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtu/vue-test-utils-en-profundidad/transiciones">Transiciones</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtu/vue-test-utils-en-profundidad/instancia-de-componente">Instancia de Componente</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtu/vue-test-utils-en-profundidad/reusabilidad-y-composicion">Reusabilidad &amp; Composición</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtu/vue-test-utils-en-profundidad/probando-vuex">Probando Vuex</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtu/vue-test-utils-en-profundidad/un-poco-mas-sobre-vuex">Un poco más sobre Vuex</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtu/vue-test-utils-en-profundidad/probando-vue-router">Probando Vue Router</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtu/vue-test-utils-en-profundidad/probando-teleport">Probando Teleport</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtu/vue-test-utils-en-profundidad/talones-y-montaje-superficial">Talones y Montaje Superficial</a><!----></li></ul></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">Vue Testing Handbook</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vth/renderizar-componentes">Renderizar Componentes</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vth/probando-propiedades">Probando Propiedades</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vth/propiedades-calculadas">Propiedades Calculadas</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vth/simulando-la-entrada-del-usuario">Simulando la entrada del usuario</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vth/probando-eventos-emitidos">Probando Eventos Emitidos</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vth/simulando-objetos-globales">Simulando Objetos Globales</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vth/talonando-componentes">Talonando Componentes</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vth/encontrando-elementos-y-componentes">Encontrando elementos y componentes</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vth/probando-vuex">Probando Vuex</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vth/vuex-mutaciones">Vuex Mutaciones</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vth/vuex-acciones">Vuex Accciones</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vth/vuex-captadores">Vuex Captadores</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vth/probando-vuex-en-componentes">Probando Vuex en componentes - estados y captadores</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vth/probando-vuex-en-componentes-mutaciones-y-acciones">Probando Vuex en componentes - mutaciones y acciones</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vth/vue-router">Vue Router</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vth/api-de-composicion">API de Composición</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vth/reduciendo-repetitividad-en-las-pruebas">Reduciendo Repetitividad en las Pruebas</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">Vue Testing Library</p><ul class="sidebar-links"><li class="sidebar-link"><p class="sidebar-link-item">Documentación</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtl/documentacion/intro">¿Qué es Testing Library?</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtl/documentacion/guias-de-principios">Guías de Principios</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtl/documentacion/intro-v">¿Qué es Vue Testing Library?</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtl/documentacion/ejemplos">Ejemplos</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">Prueba Simples y Completas</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtl/psyc/consultas-dom">Consultas DOM</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtl/psyc/filosofia">Filosofía</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtl/psyc/getby-queryby-findby">getBy, queryBy y findBy</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">Diseño Dirigido por Pruebas</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtl/ddp/intro">Introducción</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item active" href="/vue-tdd/vtl/ddp/patrones-para-probar-accesorios">Patrones para Probar Accesorios</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#los-fundamentos">Los fundamentos</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#agregar-un-validador">Agregar un validador</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#concepto-clave-separacion-de-preocupaciones">Concepto Clave: Separación de Preocupaciones</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#separacion-de-preocupaciones-caso-de-estudio">Separación de Preocupaciones - Caso de Estudio</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#otro-ejemplo">Otro Ejemplo</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#la-verdadera-prueba-¿se-refactoriza">La verdadera prueba: ¿Se refactoriza?</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#conclusion">Conclusión</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/vtl/ddp/emitir-eventos">Emitir Eventos</a><!----></li></ul></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">Pinia</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/vue-tdd/pinia/probando-pinia">Probando Pinia</a><!----></li></ul></li><!--]--></ul><!--[--><!--]--></aside><div class="sidebar-mask"></div><main class="page" data-v-7eddb2c4><div class="container" data-v-7eddb2c4><!--[--><!--]--><div style="position:relative;" class="content" data-v-7eddb2c4><div><h1 id="patrones-para-probar-accesorios" tabindex="-1">Patrones para Probar Accesorios <a class="header-anchor" href="#patrones-para-probar-accesorios" aria-hidden="true">#</a></h1><p>En esta sección, exploramos los accesorios y el tipo de pruebas que quizás desee considerar escribir. Esto lleva a un tema mucho más fundamental e importante; trazar una línea clara entre la lógica de negocios y la UI, también conocida como <em>separación de preocupaciones</em>, y cómo sus pruebas pueden ayudar a aclarar esta distinción.</p><blockquote><p>Considere una de las grandes ideas detrás de marcos como Vue y React: <strong><em>&quot;Su interfaz de usuario es una función de sus datos&quot;</em>.</strong></p></blockquote><p>Esta idea viene en muchas formas; otro es <em>&quot;interfaces impulsadas por datos&quot;</em>. Básicamente, su interfaz de usuario (UI) debe estar determinada por los datos presentes. Dados los datos <code>X</code>, su UI debería ser <code>Y</code>. En informática, esto se conoce como determinismo. Tome esta función de suma por ejemplo:</p><div class="language-js"><pre><code><span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> a <span class="token operator">+</span> b
<span class="token punctuation">}</span>
</code></pre></div><p>Una función de suma simple. Es una función pura.</p><p>Cuando se llama con el mismo valor para <code>a</code> y <code>b</code>, siempre obtienes el mismo resultado. El resultado está predeterminado. Es <em>determinista</em>. Un ejemplo de una función impura sería esta:</p><div class="language-js"><pre><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">fetchUserData</span><span class="token punctuation">(</span><span class="token parameter">userId</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/api/users/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>userId<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Una función impura - tiene un efecto secundario. No es lo ideal, pero es necesario para que la mayoría de los sistemas hagan algo útil.</p><p>Esta no es una función pura porque se basa en un recurso externo, en este caso, una API y una base de datos. Dependiendo de lo que haya en la base de datos cuando se llame, podríamos obtener un resultado diferente. Es impredecible.</p><p>¿Cómo se relaciona esto con los accesorios? Piense en un componente que decida qué representar en función de sus accesorios (no se preocupe por los datos, el cálculo o la configuración por ahora, pero se aplican las mismas ideas). Si piensa en un componente como una función y los accesorios como argumentos, se dará cuenta de que, dados los mismos accesorios, el componente siempre representará lo mismo. Su salida es determinista. Dado que usted decide qué accesorios se pasan al componente, es fácil probarlo, ya que conocemos todos los estados posibles en los que puede estar el componente.</p><h2 id="los-fundamentos" tabindex="-1">Los fundamentos <a class="header-anchor" href="#los-fundamentos" aria-hidden="true">#</a></h2><p>Puede declarar accesorios de varias maneras. Trabajaremos con el componente <code>&lt;Message&gt;</code> para este ejemplo.</p><div class="language-vue"><pre><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>variant<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Message<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token comment">// can be &#39;success&#39;, &#39;warning&#39;, &#39;error&#39;</span>
  <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;variant&#39;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>Declarar un accesorio <code>variant</code> con la sintaxis de matriz inferior.</p><p>En este ejemplo, declaramos accesorios utilizando la sintaxis de matriz: <code>props: [&#39;variant&#39;]</code>. Es recomendable evitar la sintaxis de matriz. El uso de la sintaxis de objeto le da al lector más información sobre el tipo de valores que puede tomar la variante.</p><div class="language-js"><pre><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">variant</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span>
      <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Declarar un accesorio <code>variant</code> con la sintaxis de objeto superior.</p><p>Si está utilizando TypeScript, aún mejor: cree un tipo:</p><div class="language-ts"><pre><code><span class="token keyword">type</span> <span class="token class-name">Variant</span> <span class="token operator">=</span> <span class="token string">&#39;success&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;warning&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;error&#39;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  props<span class="token operator">:</span> <span class="token punctuation">{</span>
    variant<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> String <span class="token keyword">as</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Variant<span class="token punctuation">,</span>
      required<span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Una variante fuertemente tipada usando TypeScript.</p><p>En nuestro ejemplo de <code>&lt;Message&gt;</code>, estamos trabajando con JavaScript normal, por lo que no podemos especificar cadenas específicas para las variantes de accesorios como puede hacerlo en TypeScript. Sin embargo, hay algunos otros patrones que podemos usar.</p><p>Hemos especificado que se requiere el accesorio <code>variant</code> y nos gustaría aplicar un subconjunto específico de valores de cadena que puede recibir. Vue nos permite validar accesorios usando una clave de validación. Funciona así:</p><div class="language-vue"><div class="highlight-lines"><br><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br></div><pre><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>variant<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Message! {{ variant }}?<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">variant</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token function-variable function">validator</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// if we return true, the prop is valid.</span>
        <span class="token comment">// if we return false, a runtime warning will be shown.</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>Los validadores de accesorio son funciones. Si devuelven <code>false</code>, Vue mostrará una advertencia en la consola.</p><p>¡Los validadores de accesorio son como la función de suma de la que hablamos anteriormente en el sentido de que son funciones puras! Eso significa que son fáciles de probar: dada la propiedad <code>X</code>, el validador debería devolver el resultado <code>Y</code>.</p><p>Antes de agregar un validador, escribamos una prueba simple para el componente <code>&lt;Message&gt;</code>. Queremos probar entradas y salidas. En el caso de <code>&lt;Message&gt;</code>, el accesorio <code>variant</code> es la entrada y lo que se representa es la salida. Podemos escribir una prueba para afirmar que se aplica la clase correcta usando Testing Library y el atributo <code>classList</code>:</p><div class="language-js"><pre><code><span class="token keyword">import</span> <span class="token punctuation">{</span> render <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@testing-library/vue&#39;</span>
<span class="token keyword">import</span> Message <span class="token keyword">from</span> <span class="token string">&#39;@/Message.vue&#39;</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&#39;Message&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&#39;renders variant correctly when passed&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> container <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">render</span><span class="token punctuation">(</span>Message<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">variant</span><span class="token operator">:</span> <span class="token string">&#39;success&#39;</span>
      <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  
  <span class="token function">expect</span><span class="token punctuation">(</span>container<span class="token punctuation">.</span>firstChild<span class="token punctuation">.</span>classList<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;success&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>La prueba del accesorio se aplica a la clase.</p><p>Esto verifica que todo funcione como se esperaba cuando se pasa una propiedad de variante válida a <code>&lt;Message&gt;</code>. ¿Qué pasa cuando se pasa una variante no válida? Queremos prohibir el uso del componente <code>&lt;Message&gt;</code> con una variante válida. Este es un buen caso de uso para un validador.</p><h2 id="agregar-un-validador" tabindex="-1">Agregar un validador <a class="header-anchor" href="#agregar-un-validador" aria-hidden="true">#</a></h2><p>Actualicemos el accesorio <code>variant</code> para tener un validador simple:</p><div class="language-vue"><div class="highlight-lines"><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br></div><pre><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>variant<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Message! {{ variant }}?<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">variant</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span>
      <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token function-variable function">validator</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">variant</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">[</span><span class="token string">&#39;success&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;warning&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;error&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>variant<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">throw</span> <span class="token function">Error</span><span class="token punctuation">(</span>
            <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">variant is required and must</span><span class="token template-punctuation string">`</span></span> <span class="token operator">+</span>
            <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">be either &#39;success&#39;, &#39;warning&#39; or &#39;error&#39;.</span><span class="token template-punctuation string">`</span></span> <span class="token operator">+</span>
            <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">You passed: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>variant<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
          <span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>Si <code>variant</code> no es válido, lanzamos un error.</p><p>Ahora obtendremos un error si se pasa una propiedad no válida. Una alternativa sería simplemente devolver <code>false</code> en lugar de arrojar un error; esto solo le dará una advertencia en la consola a través de <code>console.warn</code>. Los errores fuertes y claros cuando un componente no se usa correctamente quedan más protegidos.</p><p>¿Cómo probamos el validador? Si queremos cubrir todas las posibilidades, necesitamos 4 pruebas; uno para cada tipo de <code>variant</code> y otro para un tipo no válido.</p><p>Es preferible probar los validadores de accesorios de forma aislada. Dado que los validadores son generalmente funciones puras, son fáciles de probar. Tambien hay otra razón por la que se prueban los validadores de accesorios, el aislamiento, del que hablaremos después de escribir la prueba.</p><p>Para permitir probar el aislamiento del validador, necesitamos refactorizar <code>&lt;Message&gt;</code> un poco para separar el validador del componente:</p><div class="language-vue"><div class="highlight-lines"><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br></div><pre><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>variant<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Message! {{ variant }}?<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">validateVariant</span><span class="token punctuation">(</span><span class="token parameter">variant</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">[</span><span class="token string">&#39;success&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;warning&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;error&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>variant<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token function">Error</span><span class="token punctuation">(</span>
      <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">variant is required and must</span><span class="token template-punctuation string">`</span></span> <span class="token operator">+</span>
      <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">be either &#39;success&#39;, &#39;warning&#39; or &#39;error&#39;.</span><span class="token template-punctuation string">`</span></span> <span class="token operator">+</span>
      <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">You passed: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>variant<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">variant</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span>
      <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token literal-property property">validator</span><span class="token operator">:</span> validateVariant
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>Exportando el validador por separado al componente.</p><p>Genial, <code>validarVariant</code> ahora se exporta por separado y es fácil de probar:</p><div class="language-js"><div class="highlight-lines"><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br></div><pre><code><span class="token keyword">import</span> <span class="token punctuation">{</span> render <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@testing-library/vue&#39;</span>
<span class="token keyword">import</span> Message<span class="token punctuation">,</span><span class="token punctuation">{</span> validateVariant <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@/Message.vue&#39;</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&#39;Message&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&#39;renders variant correctly when passed&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> container <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">render</span><span class="token punctuation">(</span>Message<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">variant</span><span class="token operator">:</span> <span class="token string">&#39;success&#39;</span>
      <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  
  <span class="token function">expect</span><span class="token punctuation">(</span>container<span class="token punctuation">.</span>firstChild<span class="token punctuation">.</span>classList<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;success&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  
  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&#39;validates valid variant prop&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token punctuation">;</span><span class="token punctuation">[</span><span class="token string">&#39;success&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;warning&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;error&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">variant</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">expect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">validateVariant</span><span class="token punctuation">(</span>variant<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>not<span class="token punctuation">.</span><span class="token function">toThrow</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  
  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&#39;throws error for invalid variant prop&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">expect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">validateVariant</span><span class="token punctuation">(</span><span class="token string">&#39;invalid&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toThrow</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>Probando todos los casos para el validador.</p><p>El simple hecho de hacer que <code>validateVariant</code> sea una función separada que se exporte puede parecer un cambio pequeño, pero en realidad es una gran mejora. Al hacerlo, pudimos escribir pruebas para <code>validateVariant</code> con facilidad. Podemos estar seguros de que el componente <code>&lt;Message&gt;</code> solo se puede usar con un <code>variant</code> válido. Si el desarrollador pasa una propiedad inválida, recibe un mensaje claro y agradable en la consola::</p><div class="language-"><pre><code>Uncaught Error: variant is required and must be either &#39;success&#39;, &#39;warning&#39; or &#39;error&#39;.` You passed: asdf 
</code></pre></div><p>¡Error! La variante aprobada no es válida.</p><p>He aquí el mismo ejemplo con Vue Test Utils:</p><div class="language-js"><pre><code><span class="token keyword">import</span> <span class="token punctuation">{</span> mount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@vue/test-utils&#39;</span>
<span class="token keyword">import</span> Message<span class="token punctuation">,</span><span class="token punctuation">{</span> validateVariant <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@/Message.vue&#39;</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&#39;Message&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&#39;renders variant correctly when passed&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span>Message<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">variant</span><span class="token operator">:</span> <span class="token string">&#39;success&#39;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span><span class="token function">classes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span><span class="token string">&#39;success&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&#39;validates valid variant prop&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token punctuation">;</span><span class="token punctuation">[</span><span class="token string">&#39;success&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;warning&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;error&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">variant</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">expect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">validateVariant</span><span class="token punctuation">(</span>variant<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>not<span class="token punctuation">.</span><span class="token function">toThrow</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&#39;throws error for invalid variant prop&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">expect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">validateVariant</span><span class="token punctuation">(</span><span class="token string">&#39;invalid&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toThrow</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="concepto-clave-separacion-de-preocupaciones" tabindex="-1">Concepto Clave: Separación de Preocupaciones <a class="header-anchor" href="#concepto-clave-separacion-de-preocupaciones" aria-hidden="true">#</a></h2><p>Hemos escrito dos tipos diferentes de pruebas. La primera es una prueba de UI - en la que hacemos afirmaciones contra <code>classList</code>. El segundo es para el validador. Pone a prueba la lógica de negocios.</p><p>Para que esto quede más claro, imagina que tu empresa se especializa en sistemas de diseño. Tienes algunos diseñadores que probablemente usan Figma o Sketch para diseñar cosas como botones y mensajes.</p><p>Han decidido admitir tres variantes de mensajes: <em>success</em>, <em>warning</em> y <em>error</em>. Eres un desarrollador front-end. En este ejemplo, está trabajando en la integración de Vue - escribirá componentes de Vue que aplican clases específicas, que utilizan el CSS que proporcionó por los diseñadores.</p><p>En el futuro, también deberá crear componentes React y Angular utilizando el mismo CSS y las mismas pautas. Las tres integraciones podrían hacer uso de la función <code>validateVariant</code> y probar. Es la lógica de negocios central.</p><p>Esta distinción es importante. Cuando usamos los métodos de <em>Testing Library</em> (como el <code>render</code>) y las API DOM (como <code>classList</code>), verificamos que la capa de la UI de Vue funcione correctamente. La prueba de <code>validateVariant</code> es para nuestra lógica de negocios. Estas diferencias a veces se denominan <em>preocupaciones</em>. Una pieza de código se refiere a la UI. El otro se ocupa de la lógica de negocios.</p><p>Separarlos es bueno. Hace que su código sea más fácil de probar y mantener. Este concepto se conoce como <em>separación de preocupaciones</em>. Revisaremos esto a lo largo de este contenido.</p><p>Si desea saber si algo es parte de la UI o la lógica de negocios, pregúntese esto: &quot;si cambiara a React, ¿podría reutilizar este código y probarlo?&quot;.</p><p>En este caso, podría reutilizar el validador y su prueba cuando escriba la integración de React. El validador se preocupa por la lógica de negocios y no sabe nada sobre el marco de la UI. Vue o React, solo admitiremos tres variantes de mensajes: <em>success</em>, <em>warning</em> y <em>error</em>. El componente y la prueba del componente (donde afirmamos usar <code>classes()</code>) tendrían que reescribirse usando un componente React y una biblioteca de pruebas React.</p><p>Idealmente, no desea que su lógica de negocios se acople a su marco de trabajo de elección; Los marcos van y vienen, pero es poco probable que los problemas que su negocio está resolviendo cambien significativamente.</p><p>He visto que la separación deficiente de las preocupaciones le cuesta a las empresas decenas de miles de dólares; llegan a un punto en el que agregar nuevas funciones es arriesgado y lento, porque el problema principal de su negocio está demasiado relacionado con la UI. Reescribir la UI significa reescribir la lógica de negocios.</p><h2 id="separacion-de-preocupaciones-caso-de-estudio" tabindex="-1">Separación de Preocupaciones - Caso de Estudio <a class="header-anchor" href="#separacion-de-preocupaciones-caso-de-estudio" aria-hidden="true">#</a></h2><p>Un ejemplo de separación deficiente de las preocupaciones que cuestan a una organización fue una aplicación en la que trabajé para un proveedor de componentes eléctricos. Tenían una aplicación que los clientes usarían para obtener una cotización aproximada del precio de los componentes. El proceso de pedido era bastante complejo: tenía que pasar por un formulario con varios pasos y los valores del paso anterior afectarían los campos del paso siguiente.</p><p>La aplicación se escribió usando jQuery (que no está mal. Ningún marco es malo, solo si se usan incorrectamente). Toda la lógica de negocios se mezcló con la lógica de la UI (esta es la parte mala). Tenían un modelo de descuento basado en la cantidad: &quot;Si compra más de 50 resistencias, aplique un descuento X, de lo contrario Y&quot; - este tipo de cosas. Decidieron pasar a algo un poco más moderno: la UI estaba muy anticuada y no era compatible con dispositivos móviles en absoluto. La complejidad del código jQuery era alta y el código era un desastre.</p><p>No solo tuve que volver a escribir toda la capa de la UI (que era para lo que me pagaron), sino que también tuve que volver a escribir o extraer la gran mayoría de la lógica de negocios desde el código jQuery. Esta misión de búsqueda y extracción hizo que la tarea fuera mucho más difícil y arriesgada de lo que debería haber sido: en lugar de solo actualizar la capa de la UI, también tuve que sumergirme y aprender su modelo comercial y de precios (que terminó tomando mucho más tiempo y cuesta mucho más de lo que probablemente debería).</p><p>Aquí hay un ejemplo concreto usando el escenario del mundo real anterior. Digamos que una resistencia (un tipo de componente eléctrico) cuesta $0,60. Si compras más de 50, obtienes un 20% de descuento. El código base de jQuery se parecía a esto:</p><div class="language-js"><pre><code><span class="token keyword">const</span> $resistorCount <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;#resistors-count&#39;</span><span class="token punctuation">)</span>
$resistorCount<span class="token punctuation">.</span><span class="token function">change</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> amount <span class="token operator">=</span> <span class="token function">parseInt</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
  <span class="token keyword">const</span> totalCost <span class="token operator">=</span> <span class="token number">0.6</span> <span class="token operator">*</span> amount
  <span class="token keyword">const</span> $price <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#price&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>amount <span class="token operator">&gt;</span> <span class="token number">50</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    $price<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span>totalCost <span class="token operator">*</span> <span class="token number">0.8</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    $price<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span>totalCost<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>Debe observar con mucho cuidado para descubrir dónde termina la UI y comienza el negocio. En este escenario, quería cambiarme a Vue, la herramienta perfecta para una forma altamente dinámica y reactiva. Tuve que profundizar en el código base y descubrir esta parte central de la lógica de negocios, extraerla y reescribirla con algunas pruebas (por supuesto, el código base anterior no tenía pruebas, como muchas bases de código de principios de la década de 2000). ¡Este viaje de búsqueda, extracción, aislamiento y reescritura está lleno de riesgos y la posibilidad de cometer un error o perderse algo es muy alta! Lo que hubiera sido mucho mejor es si la lógica de negocios y la UI se hubieran separado:</p><div class="language-js"><pre><code><span class="token keyword">const</span> resistorPrice <span class="token operator">=</span> <span class="token number">0.6</span>
<span class="token keyword">function</span> <span class="token function">resistorCost</span><span class="token punctuation">(</span><span class="token parameter">price<span class="token punctuation">,</span> amount</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>amount <span class="token operator">&gt;</span> <span class="token number">50</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> price <span class="token operator">*</span> amount <span class="token operator">*</span> <span class="token number">0.8</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> price <span class="token operator">*</span> amount
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

$resistorCount<span class="token punctuation">.</span><span class="token function">change</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> amount <span class="token operator">=</span> <span class="token function">parseInt</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
  <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#price&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token function">resistorCost</span><span class="token punctuation">(</span>resistorPrice<span class="token punctuation">,</span> amount<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>El segundo es muy superior. Puede ver dónde termina la lógica de negocios y comienza la UI: están literalmente separados en dos funciones diferentes. La estrategia de precios es clara: un descuento por cualquier cantidad superior a 50. También es muy fácil probar la lógica de negocios de forma aislada. Si llega el día en que decide que su marco de trabajo de elección ya no es apropiado, es trivial cambiar a otro marco: sus pruebas de unidad de lógica de negocios pueden permanecer sin cambios y sin tocar, y es de esperar que también tenga algunas pruebas de navegador de extremo a extremo para mantenerlo a salvo.</p><p>Pasarse a Vue es trivial: tampoco es necesario tocar la lógica de negocios:</p><div class="language-vue"><pre><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>amount<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>Price: {{ totalCost }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> resistorCost<span class="token punctuation">,</span> resistorPrice <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./logic.js&#39;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">amount</span><span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">computed</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">totalCost</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">resistorCost</span><span class="token punctuation">(</span>resistorPrice<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>amount<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>Comprender e identificar las diferentes preocupaciones en un sistema y estructurar correctamente las aplicaciones es la diferencia entre buenos ingenieros y grandes ingenieros.</p><h2 id="otro-ejemplo" tabindex="-1">Otro Ejemplo <a class="header-anchor" href="#otro-ejemplo" aria-hidden="true">#</a></h2><p>Suficiente filosofía de diseño por ahora. Veamos otro ejemplo relacionado con <code>props.</code> Este ejemplo usa el componente <code>&lt;Navbar&gt;</code>. Puede encontrarlo en <code>examples/props/navbar.vue</code>. Se parece a esto:</p><div class="language-vue"><pre><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>authenticated<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Logout<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>!authenticated<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Login<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">authenticated</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> Boolean<span class="token punctuation">,</span>
      <span class="token keyword">default</span><span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>El componente de la barra de navegación. Tiene un accesorio, autenticado. Es falso por defecto.</p><p>Antes incluso de ver la prueba, está claro que necesitamos dos pruebas para cubrir todos los casos de uso. La razón por la que esto queda claro de inmediato es que la propiedad <code>authenticated</code> es un <code>Boolean</code>, que solo tiene dos valores posibles.</p><p>La prueba no es especialmente interesante (¡pero la discusión que sigue sí lo es!):</p><div class="language-js"><pre><code><span class="token keyword">import</span> <span class="token punctuation">{</span> render<span class="token punctuation">,</span> screen <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@testing-library/vue&#39;</span>
<span class="token keyword">import</span> Navbar <span class="token keyword">from</span> <span class="token string">&#39;@/Navbar.vue&#39;</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&#39;Navbar&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&#39;shows logout when authenticated is true&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">render</span><span class="token punctuation">(</span>Navbar<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">authenticated</span><span class="token operator">:</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token comment">// getByText will throw an error if it cannot find the element.</span>
    screen<span class="token punctuation">.</span><span class="token function">getByText</span><span class="token punctuation">(</span><span class="token string">&#39;Logout&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&#39;shows login by default&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">render</span><span class="token punctuation">(</span>Navbar<span class="token punctuation">)</span>
    screen<span class="token punctuation">.</span><span class="token function">getByText</span><span class="token punctuation">(</span><span class="token string">&#39;Login&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>Probar el comportamiento de la barra de navegación para todos los valores de autenticados.</p><p>Lo único que cambia según el valor de <code>authenticated</code> es el texto del botón. Dado que el valor <code>default</code> es <code>false</code>, no necesitamos pasarlo como <code>props</code> en la segunda prueba.</p><p>Podemos refactorizar un poco con una función <code>renderNavbar</code>:</p><div class="language-js"><pre><code><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&#39;Navbar&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">renderNavbar</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">render</span><span class="token punctuation">(</span>Navbar<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      props
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  
  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&#39;shows login authenticated is true&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">renderNavbar</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">authenticated</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    screen<span class="token punctuation">.</span><span class="token function">getByText</span><span class="token punctuation">(</span><span class="token string">&#39;Logout&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  
  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&#39;shows logout by default&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">renderNavbar</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    screen<span class="token punctuation">.</span><span class="token function">getByText</span><span class="token punctuation">(</span><span class="token string">&#39;Login&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>Pruebas más concisas.</p><p>Me gusta más esta versión de la prueba. Puede parecer un poco superficial para una prueba tan simple, pero a medida que sus componentes se vuelven más complejos, tener una función para abstraer parte de la complejidad puede hacer que sus pruebas sean más legibles.</p><p>También eliminé la nueva línea entre la representación del componente y la afirmación. Por lo general, no dejo líneas nuevas en mis pruebas cuando son tan simples. Cuando se vuelven más complejos, me gusta dejar algo de espacio, creo que lo hace más legible. Este es solo mi enfoque personal. Lo importante no es tu estilo de código, sino que estás escribiendo pruebas.</p><p>Aunque técnicamente hemos cubierto todos los casos, me gustaría agregar el tercer caso: donde <code>authenticated</code> se establece explícitamente en <code>false</code>.</p><div class="language-js"><pre><code><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&#39;Navbar&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">renderNavbar</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">render</span><span class="token punctuation">(</span>Navbar<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      props
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&#39;shows login authenticated is true&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&#39;shows logout by default&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&#39;shows login when authenticated is false&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">renderNavbar</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">authenticated</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    screen<span class="token punctuation">.</span><span class="token function">getByText</span><span class="token punctuation">(</span><span class="token string">&#39;Login&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>Agregar una tercera prueba para ser explícito.</p><p>Esto, por supuesto, pasa. Me gusta mucho la simetría que exhiben las tres pruebas, mostrando los tres casos de una manera tan concisa.</p><p>Repasemos la idea de la separación de preocupaciones; ¿Es esta una prueba de UI o una prueba de lógica de negocios? Si moviéramos el marco, ¿podríamos reutilizar esta prueba?</p><p>La respuesta es no: necesitaríamos escribir una nueva prueba (para trabajar con React y su integración con la biblioteca de pruebas). Esto está bien, solo significa que esta parte de nuestro código base es parte de la capa de la UI, no nuestra lógica de negocios central. Nada que extraer.</p><h2 id="la-verdadera-prueba-¿se-refactoriza" tabindex="-1">La verdadera prueba: ¿Se refactoriza? <a class="header-anchor" href="#la-verdadera-prueba-¿se-refactoriza" aria-hidden="true">#</a></h2><p>Podemos hacer una pequeña verificación de cordura y asegurarnos de que nuestras pruebas no estén probando detalles de implementación. Los detalles de implementación se refieren a <em>cómo</em> funciona algo. Al realizar pruebas, no nos importan los detalles de cómo funciona algo. En cambio, nos preocupamos por lo <em>qué</em> hace y si lo hace correctamente. Recuerde, debemos probar que obtenemos el resultado esperado en función de las entradas dadas. En este caso, queremos probar que el texto correcto se represente en función de los datos, sin preocuparnos demasiado por cómo se implementa realmente la lógica.</p><p>Podemos validar esto refactorizando el componente <code>&lt;Navbar&gt;</code>. Mientras las pruebas continúen, podemos estar seguros de que son resistentes a los refactores y están probando comportamientos, no detalles de implementación.</p><div class="language-vue"><pre><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><span class="token punctuation">&gt;</span></span>
    {{ `${authenticated ? &#39;Logout&#39; : &#39;Login&#39;}` }}
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">authenticated</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> Boolean<span class="token punctuation">,</span>
      <span class="token keyword">default</span><span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>Refactorizando <code>Navbar</code>. ¡El comportamiento sigue siendo el mismo!</p><p>¡Todo todavía pasa! Nuestras pruebas están haciendo lo que se supone que deben hacer. ¿O son? ¿Qué pasa si decidimos que nos gustaría usar una etiqueta <code>&lt;a&gt;</code> en lugar de un <code>&lt;button&gt;</code>?</p><div class="language-vue"><pre><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span><span class="token punctuation">&gt;</span></span>
    {{ `${authenticated ? &#39;Logout&#39; : &#39;Login&#39;}` }}
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">authenticated</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> Boolean<span class="token punctuation">,</span>
      <span class="token keyword">default</span><span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>Usar una etiqueta de anclaje en lugar de un botón.</p><p>Obviamente, en un sistema real se requeriría una propiedad <code>href</code> y cambiaría dependiendo de <code>authenticated</code>, pero eso no es en lo que nos estamos enfocando aquí. Todavía pasa. ¡Una gran noticia! Nuestras pruebas sobrevivieron a dos refactorizaciones; esto significa que estamos probando el comportamiento, no los detalles de implementación, lo cual es bueno.</p><p>He aquí el mismo ejemplo con Vue Test Utils:</p><div class="language-js"><pre><code><span class="token keyword">import</span> <span class="token punctuation">{</span> mount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@vue/test-utils&#39;</span>
<span class="token keyword">import</span> Navbar <span class="token keyword">from</span> <span class="token string">&#39;@/Navbar.vue&#39;</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&#39;Navbar&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">navbarFactory</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">mount</span><span class="token punctuation">(</span>Navbar<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      props
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&#39;shows login authenticated is true&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">navbarFactory</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">authenticated</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span><span class="token string">&#39;Logout&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&#39;shows logout by default&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">navbarFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">&#39;a&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token string">&#39;Login&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&#39;shows login when authenticated is false&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">navbarFactory</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">authenticated</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">&#39;a&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token string">&#39;Login&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="conclusion" tabindex="-1">Conclusión <a class="header-anchor" href="#conclusion" aria-hidden="true">#</a></h2><p>Este capítulo discutió algunas técnicas para probar propiedades. También vimos cómo usar el método <code>render</code> de Testing Library para probar componentes. Hablamos del concepto de <em>separación de preocupaciones</em> y de cómo puede hacer que su lógica de negocios sea más comprobable y sus aplicaciones más fáciles de mantener. Finalmente, vimos cómo las pruebas pueden permitirnos refactorizar el código con confianza.</p></div></div><footer class="page-footer" data-v-7eddb2c4 data-v-07c132fc><div class="edit" data-v-07c132fc><div class="edit-link" data-v-07c132fc data-v-1ed99556><!----></div></div><div class="updated" data-v-07c132fc><!----></div></footer><div class="next-and-prev-link" data-v-7eddb2c4 data-v-38ede35f><div class="container" data-v-38ede35f><div class="prev" data-v-38ede35f><a class="link" href="/vue-tdd/vtl/ddp/intro" data-v-38ede35f><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon icon-prev" data-v-38ede35f><path d="M19,11H7.4l5.3-5.3c0.4-0.4,0.4-1,0-1.4s-1-0.4-1.4,0l-7,7c-0.1,0.1-0.2,0.2-0.2,0.3c-0.1,0.2-0.1,0.5,0,0.8c0.1,0.1,0.1,0.2,0.2,0.3l7,7c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3c0.4-0.4,0.4-1,0-1.4L7.4,13H19c0.6,0,1-0.4,1-1S19.6,11,19,11z"></path></svg><span class="text" data-v-38ede35f>Introducción</span></a></div><div class="next" data-v-38ede35f><a class="link" href="/vue-tdd/vtl/ddp/emitir-eventos" data-v-38ede35f><span class="text" data-v-38ede35f>Emitir Eventos</span><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon icon-next" data-v-38ede35f><path d="M19.9,12.4c0.1-0.2,0.1-0.5,0-0.8c-0.1-0.1-0.1-0.2-0.2-0.3l-7-7c-0.4-0.4-1-0.4-1.4,0s-0.4,1,0,1.4l5.3,5.3H5c-0.6,0-1,0.4-1,1s0.4,1,1,1h11.6l-5.3,5.3c-0.4,0.4-0.4,1,0,1.4c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3l7-7C19.8,12.6,19.9,12.5,19.9,12.4z"></path></svg></a></div></div></div><!--[--><!--]--></div></main></div><!----><!--]--></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"comenzar_pruebas-unitarias.md\":\"072a0779\",\"comenzar_tdd.md\":\"83c178f6\",\"index.md\":\"e8b75c64\",\"pinia_probando-pinia.md\":\"b3d27b46\",\"vitest_configuracion-y-desmontaje.md\":\"2df6d6b9\",\"vitest_entorno-de-prueba.md\":\"b8538419\",\"vitest_filtrando-pruebas.md\":\"b246763e\",\"vitest_funciones-simuladas.md\":\"44943bc8\",\"vitest_porque-vitest.md\":\"f26514a0\",\"vitest_probando-codigo-asincrono.md\":\"d101f698\",\"vitest_simulaciones-de-clase-es6.md\":\"573bda09\",\"vitest_simulaciones-de-temporizador.md\":\"1367c514\",\"vitest_simulaciones.md\":\"bf9da096\",\"vitest_un-ejemplo-asincrono.md\":\"677cdb0d\",\"vitest_usando-comparadores.md\":\"85018778\",\"vth_api-de-composicion.md\":\"c9eef5ae\",\"vth_encontrando-elementos-y-componentes.md\":\"e8685ddb\",\"vth_probando-eventos-emitidos.md\":\"258fff98\",\"vth_probando-propiedades.md\":\"edf828e2\",\"vth_probando-vuex-en-componentes-mutaciones-y-acciones.md\":\"ceb2ecad\",\"vth_probando-vuex-en-componentes.md\":\"976c7937\",\"vth_probando-vuex.md\":\"4038581b\",\"vth_propiedades-calculadas.md\":\"de9350c0\",\"vth_reduciendo-repetitividad-en-las-pruebas.md\":\"7caced04\",\"vth_renderizar-componentes.md\":\"6d5debd9\",\"vth_simulando-la-entrada-del-usuario.md\":\"683c8a2d\",\"vth_simulando-objetos-globales.md\":\"76d1c5ce\",\"vth_talonando-componentes.md\":\"768fe850\",\"vth_vue-router.md\":\"9a96d7e4\",\"vth_vuex-acciones.md\":\"dc00e563\",\"vth_vuex-captadores.md\":\"1cc9bccb\",\"vth_vuex-mutaciones.md\":\"f6b417cd\",\"vtl_ddp_emitir-eventos.md\":\"2b19cd90\",\"vtl_ddp_intro.md\":\"4ceeff64\",\"vtl_ddp_patrones-para-probar-accesorios.md\":\"82bdd52c\",\"vtl_documentacion_ejemplos.md\":\"36a087e8\",\"vtl_documentacion_guias-de-principios.md\":\"eac38c87\",\"vtl_documentacion_intro-v.md\":\"39a9da22\",\"vtl_documentacion_intro.md\":\"b3e96352\",\"vtl_psyc_consultas-dom.md\":\"2e312dde\",\"vtl_psyc_filosofia.md\":\"6a9a3c2d\",\"vtl_psyc_getby-queryby-findby.md\":\"39cb3205\",\"vtu_esencial_entorno-de-prueba.md\":\"58cd99ca\",\"vtu_esencial_escribir-componentes-que-sean faciles-de-probar.md\":\"898c12db\",\"vtu_esencial_formularios.md\":\"16ebefcc\",\"vtu_esencial_intro.md\":\"7d8bd232\",\"vtu_esencial_manejo-de-eventos.md\":\"45d2ad9e\",\"vtu_esencial_pasando-datos-a-componentes.md\":\"213ec72f\",\"vtu_esencial_renderizado-condicional.md\":\"6d6cb6e6\",\"vtu_esencial_un-curso-acelerado.md\":\"9f4ae51e\",\"vtu_vue-test-utils-en-profundidad_comportamiento-asincrono.md\":\"3635ba2c\",\"vtu_vue-test-utils-en-profundidad_instancia-de-componente.md\":\"b0565645\",\"vtu_vue-test-utils-en-profundidad_probando-teleport.md\":\"7609a12d\",\"vtu_vue-test-utils-en-profundidad_probando-vue-router.md\":\"fdd3c82c\",\"vtu_vue-test-utils-en-profundidad_probando-vuex.md\":\"a09d453b\",\"vtu_vue-test-utils-en-profundidad_ranuras.md\":\"8831c38d\",\"vtu_vue-test-utils-en-profundidad_reusabilidad-y-composicion.md\":\"d9bf0539\",\"vtu_vue-test-utils-en-profundidad_solicitudes-http.md\":\"e40a2434\",\"vtu_vue-test-utils-en-profundidad_talones-y-montaje-superficial.md\":\"d18925a9\",\"vtu_vue-test-utils-en-profundidad_transiciones.md\":\"3d0da3fa\",\"vtu_vue-test-utils-en-profundidad_un-poco-mas-sobre-vuex.md\":\"e5c0e55f\"}")</script>
    <script type="module" async src="/vue-tdd/assets/app.c20c0d51.js"></script>
    
  </body>
</html>